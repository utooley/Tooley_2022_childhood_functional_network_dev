---
title: The age of reason — Functional brain network development during childhood
author: Ursula A. Tooley^1,2^, Anne T. Park^1^, Julia A. Leonard^3^, Austin L. Boroshok^1^, Cassidy L. McDermott^1^, M. Dylan Tisdall^4^, Dani S. Bassett^5,6,7,8,9,10^, \& Allyson P. Mackey^1^
date: Created `r Sys.Date()`
output:
  word_document:
    reference_docx: ref-style-serif.docx
  pdf_document:
    toc: yes
    toc_depth: '6'
csl: the-journal-of-neuroscience.csl
bibliography: doc_references.bib
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
#### PACKAGES ####
library(redoc)
library(dplyr)
library(stats)
library(parallel)
library(lm.beta)
library(packrat)
library(summarytools)
library(visreg)
library(mgcv)
library(RLRsim)
library(GGally)
library(stringr)
library(tidyverse)
library(data.table)
library(bigmemory)
library(biglm)
library(effectsize)
library(car)
library(papaja)
options(digits=3, scipen = 999)

#Fix apa_print for bigger pvalues
#trace(papaja:::arrange_regression, edit=T)
#source("~/Documents/tools/papaja_fix_apa_print_long_pvalues.R")
#environment(arrange_regression) <- asNamespace('papaja')
#assignInNamespace("arrange_regression", arrange_regression, ns = "papaja")
#Load data
pipeline='gsr_spkreg_fd0.5dvars1.75_drpvls'
network_dir=paste0("~/Documents/projects/in_progress/within_between_network_conn_CBPD/data/imageData/",pipeline)
load(paste0(network_dir,"/CBPD_n92_schaefer400_allruns.Rdata"))
```

## Affiliations

^1^ Department of Psychology, School of Arts and Sciences, University of Pennsylvania, Philadelphia, PA 19104, USA\
^2^ Neuroscience Graduate Group, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA\
^3^ Department of Psychology, Yale University, New Haven, CT 06520, USA\
^4^ Department of Radiology, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA, 19104\
^5^ Department of Bioengineering, School of Engineering and Applied Sciences, University of Pennsylvania, Philadelphia, PA 19104, USA\
^6^ Department of Electrical & Systems Engineering, School of Engineering and Applied Science, University of Pennsylvania, Philadelphia, PA 19104, USA\
^7^ Department of Physics & Astronomy, School of Arts and Sciences, University of Pennsylvania, Philadelphia, PA 19104, USA\
^8^ Department of Neurology, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA\
^9^ Department of Psychiatry, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA 19104, USA\
^10^ Santa Fe Institute, Santa Fe, NM 87501 USA

**Corresponding author:** [mackeya\@upenn.edu](mailto:mackeya@upenn.edu){.email} \newpage

# Abstract

Human childhood is characterized by dramatic changes in the mind and brain. However, little is known about the large-scale intrinsic cortical network changes that occur during childhood due to methodological challenges in scanning young children. Here, we overcome this barrier by using sophisticated acquisition and analysis tools to investigate functional network development in children between the ages of 4 and 10 years ($n = 92$). At multiple spatial scales, age is positively associated with brain network segregation. At the system level, age was associated with segregation of systems involved in attention from those involved in abstract cognition, and with integration among attentional and perceptual systems. Associations between age and functional connectivity are most pronounced in visual and medial prefrontal cortex, the two ends of a gradient from perceptual, externally oriented cortex to abstract, internally oriented cortex. These findings suggest that both ends of the sensory-association gradient may develop early, in contrast to the classical theories that cortical maturation proceeds from back to front, with sensory areas developing first and association areas developing last. More mature patterns of brain network architecture, controlling for age, were associated with better visuospatial reasoning abilities. Our results suggest that as cortical architecture becomes more specialized, children become more able to reason about the world and their place in it.

**Keywords:** childhood, functional network, development, graph theory, reasoning

# Significance

Anthropologists have called the transition from early to middle childhood the "age of reason", when children across cultures become more independent. We employ cutting-edge neuroimaging acquisition and analysis approaches to investigate associations between age and functional brain architecture in childhood. Age was positively associated with segregation between cortical systems that process the external world, and those that process abstract phenomena like the past, future, and minds of others. Surprisingly, we observed pronounced development at both ends of the sensory-association gradient, challenging the theory that sensory areas develop first and association areas develop last. Our results open new directions for research into how brains reorganize to support rapid gains in cognitive and socioemotional skills as children reach the age of reason.

# Introduction

Children's minds develop fastest during the first decade of life. Sensory and motor skills develop before complex cognitive skills: children can see and walk before they can solve abstract puzzles. Diverse skills including reasoning, executive function, emotion regulation, and social cognition all improve dramatically until 8-10 years of age, after which change slows down (see @akshoomoff_nih_2014; @kopp_regulation_1989; @wellman2014making; @whitaker_neuroscientific_2018; <span custom-style="BlueColor">but see also @fortenbaughSustainedAttentionLife2015</span>). Developmental psychologists once called these changes the "5-to-7-year shift": the transition from Piaget's preoperational stage, in which children rely on perceptual information, to the concrete operational stage, in which children are less bound by perceptual information and more able to think abstractly [@sameroff_five_1996]. Anthropologists have called this developmental period the "age of reason" or the "age of sense", when children become more independent from their parents, begin to build more complex social relationships with peers and other adults, and become less egocentric and more able to understand others' perspectives [@chandler_shifting_1996; @lancy2014anthropology].

A core tenet of developmental cognitive neuroscience is that brain development proceeds along the sensory-association axis, with sensory areas developing first and association areas developing last [@sydnor_neurodevelopment_2021; @tooley_environmental_2021]. This sequence is in line with data from both behavioral and cognitive development [@cole2005development]. The far end of the association axis is anchored by the default mode system [@smallwood_default_2021], which is furthest from sensory input and engages primarily in abstract cognitive processes that do not rely on the current sensory environment. Examples of such processes include remembering the past, projecting the future, and taking the perspective of others [@buckner_brains_2019]. Other association systems, such as the dorsal and ventral attention systems, receive and process more input from the outside world [@corbetta_control_2002]. The frontoparietal system can be thought of as a toggle controlling the switch between internally and externally oriented cognition, flexibly coordinating other systems and holding sensory information online. Such processes are commonly exemplified in working memory and reasoning tasks [@cole_multi-task_2013; @owen_n-back_2005].

Data on structural brain development, including cortical thinning, surface area, and white matter coherence, clearly support early development of sensory areas [@gennatas_age-related_2017; @raznahan_how_2011; @reynolds_global_2019; @stiles_basics_2010; @whitaker_adolescence_2016]. However, regions of the default mode system, including the medial prefrontal cortex and the precuneus, also show early structural development [@brown_brain_2012; @li_mapping_2013; @li_spatial_2015; @wierenga_unique_2014]. Thus, another possibility is that both ends of the sensory-association axis become anchored early in life, and developmental processes differentiate and refine the boundaries of attention and executive systems along this axis later in development. Brain structure is easier to measure than function in sleeping children, so it has been better characterized in early childhood (see @houston_neurobiology_2014 and @lenroot_brain_2006). However, brain function may be more closely linked to cognition and behavior [@dhamala_distinct_2021; @zimmermann_unique_2018], particularly during development when the brain is highly plastic [@chen_shared_2020].

Functional brain networks can be studied at multiple spatial scales: in the whole brain, across systems, and among regions or parcels. Understanding how functional networks reorganize at the whole brain level allows us to examine the extent to which segregation is an overall guiding principle of development, while studying the constituent systems (sometimes referred to as "networks'' in the literature) allows for examination of relationships among specialized functional subnetworks. The parcel resolution yields more granular detail about which specific brain areas, or network nodes, might drive effects. Segregation refers to the presence of groups or subnetworks of densely interconnected nodes, and is thought to emerge partially as a result of maturing inhibitory interneurons; synchronized inhibition may be necessary for establishing segregated network function [@cardin_inhibitory_2018; @chini_developmental_2021; @kraft_electrically_2020].

Functional network development has been studied predominantly in middle childhood (7-10 years) or later (see @morgan_network_2018 and @grayson_development_2017 for review), due to the challenges of acquiring high quality data in younger children while they are awake. From middle childhood through adolescence, at the whole brain level, networks become more modular and segregated with age, supporting improved cognition [@grayson_development_2017; @gu_emergence_2015; @marek_identifying_2019; @satterthwaite_heterogeneous_2013]. At the system resolution, age is associated with increases in within-system connectivity, and decreases in between-system connectivity, particularly between the default mode system and executive control and attention systems [@chai_selective_2013; @fair_maturing_2008; @gu_emergence_2015; @jones_segregation_2021; @lopez_development_2019; @satterthwaite_heterogeneous_2013]. At the regional level, effects are less consistent, perhaps because findings vary widely depending on the age range studied [@grayson_development_2017; @morgan_network_2018]. Another way to examine parcel-level effects is to examine the development of the sensory-association axis across cortex. Two recent and well-powered studies found that in middle childhood, a sensory-association gradient is in place, but the most variance in patterns of connectivity is explained by separation between visual and somatomotor systems [@dong_shifting_2021; @xia_development_2022]. By age 12 years, however, the organization of the sensory-association gradient resembles that of adults; development of the primary sensory-association gradient may be mediated by changes in network architecture [@dong_shifting_2021; @xia_development_2022]. Functional network architecture has been shown to have cognitive consequences: youth with more segregated networks, and in particular task-positive (i.e., attention and control systems) and task-negative (i.e., default mode) systems, perform better on a wide variety of cognitive tasks [@gu_emergence_2015; @jones_segregation_2021; @lopez_development_2019; @marek_identifying_2019; @xia_development_2022].

A few studies have characterized functional network development in children younger than 6 years of age, and overall suggest developmental specialization of cortex with age. *In utero*, a proto-default-mode system is detectable, and visual and motor systems show overlap with that found in adults, but attention and frontoparietal systems remain undifferentiated [@thomason_development_2020; @turk_functional_2019]. Infant brain networks can be studied during sleep: primary sensory systems have an adult-like architecture at birth, but default, ventral attention, and dorsal attention systems do not develop a distributed network architecture until 1-2 years of age, and executive control systems are still immature at 2 years of age [@gilmore_imaging_2018]. The anticorrelation between default and dorsal attention system connectivity begins to emerge around 1 year of age (see @gao_synchronization_2013, $n = 147$). From the age of 3 months to 6 years, within-system connectivity broadly increases with age, while between-system connectivity decreases (see @bruchhage_functional_2020, $n = 196$, natural sleep). Another way to address challenges involved in scanning young children is to have them view movies: a study of children aged 4 to 7 years showed that age was positively associated with connectivity in systems identified with an independent component analysis, including sensory, motor, default mode, and executive control systems, but not the ventral attention system (see @rohr_functional_2018, $n = 60$). An analysis of the same sample also found that age was negatively associated with connectivity between seeds in the dorsal attention system (intraparietal sulcus, frontal eye fields) and areas of the default mode system (@rohr_functional_2017, $n = 44$). In general, more mature patterns of connectivity are associated with better performance on measures of attention and cognition [@bruchhage_functional_2020; @qi_associated_2021; @rohr_functional_2017; @rohr_functional_2018]. These studies of young children have examined connectivity between specific regions or subsets of regions, but not the architecture of intrinsic cortical networks at rest. Hence, little is known about how rewiring of intrinsic functional networks supports the profound cognitive changes that take place during childhood.

**The present research**

Here we focused on functional brain network development between the ages of 4 and 10 years ($n = 92$). To overcome barriers associated with resting-state data collection from young children, we applied sophisticated neuroimaging acquisition and analysis approaches to minimize motion and its impacts, including sequences optimized to reduce motion artifacts [@tisdall_volumetric_2012], real-time motion monitoring [@dosenbach_real-time_2017], rigorous image quality assurance using open-source tools, and a preprocessing pipeline optimized to reduce the impact of head motion. We used network science tools to take a hierarchical analytical approach, asking first whether whole-brain measures of network topology are associated with age, and then which systems and parcels of cortex drive patterns of topological refinement. Finally, we asked whether network structure was associated with cognition. We focused on reasoning because it is a core skill that develops rapidly until middle childhood [@whitaker_neuroscientific_2018], is highly predictive of later academic outcomes [@ferrer_longitudinal_2007; @fuchs_cognitive_2006; @pagani_fluid_2017], and was assessed across the majority of our sample. If age-associated changes in network architecture support reasoning skills, then individual differences in reasoning, controlling for age, should mirror associations with age. In other words, we predict that children with<span custom-style="BlueColor"> more mature functional architecture —i.e.,</span> greater network segregation— should have better cognitive skills.

# Materials & Methods

## Participants

```{r demographics, include=FALSE, echo=FALSE}
library(stringi)
mean_age <- mean(main_unique$age_scan)
sd_age <- sd(main_unique$age_scan)
sum(main_unique$race_black)/dim(main_unique)[1]
sum(main_unique$race_white)/dim(main_unique)[1]
sum(main_unique$race_asian)/dim(main_unique)[1]
(sum(main_unique$race_other)+sum(main_unique$race_americanindian)+sum(main_unique$race_hawaiian))/dim(main_unique)[1]
sum(main_unique$ethnicity=="Hispanic or Latino", na.rm = T)/dim(main_unique)[1]
female_perc <- sum(main_unique$male=="Female")/dim(main_unique)[1]*100
male_perc <- sum(main_unique$male=="Male")/dim(main_unique)[1]*100
table(main_unique$avg_parentedu)/dim(main_unique)[1]
table(main_unique$income_median)/dim(main_unique)[1]

#Check differences between sample included and excluded 
#differences <- setdiff(main$ID,main_unique$ID);main_excluded <- filter(main,ID %in% differences)

main_excluded <- main %>% filter(., fd_mean_avg > 1 | pctSpikesFD_avg > 0.3)
#main_excluded <- main %>% filter(., fd_mean_avg > 0.5)
#take only the first data we have from a subject
main_excluded$base_ID <- stri_split(main_excluded$record_id.y,fixed="_", simplify=T)[,1]
main_excluded$longitudinal_visit_num[is.na(main_excluded$longitudinal_visit_num)] <- 1
#only take one set of brain data from each participant, no matter the timepoint.
main_exclude <- main_excluded  %>% group_by(base_ID) %>% arrange(longitudinal) %>% filter(row_number() == 1)
dim(main_exclude)
options(digits=2)
age_of_excluded_participants <- apa_print(t.test(main_exclude$age_scan, main_unique$age_scan))
#wilcox.test(main_exclude$age_scan, main_unique$age_scan)

main_exclude$matrix_reasoning_both <- ifelse(is.na(main_exclude$wppsi_matrix_valid),main_exclude$wisc_matrix_scaled,ifelse(main_exclude$wppsi_matrix_valid==0,NA,main_exclude$wppsi_matrix_scaled))
main_exclude$matrix_reasoning_both_raw <- ifelse(is.na(main_exclude$wppsi_matrix_valid),main_exclude$wisc_matrix_raw,ifelse(main_exclude$wppsi_matrix_valid==0,NA,main_exclude$wppsi_matrix_raw))
main_exclude$matrix_reasoning_both;main_exclude$matrix_reasoning_both_raw
main_unique$matrix_reasoning_both <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_scaled,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_scaled))
main_unique$matrix_reasoning_both_raw <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_raw,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_raw))
main_unique$matrix_reasoning_both;main_unique$matrix_reasoning_both_raw

reasoning_of_excluded_participants <- apa_print(t.test(main_exclude$matrix_reasoning_both, main_unique$matrix_reasoning_both)) 

#Check differences between sample included and excluded in smaller sample
pipeline='gsr_spkreg_fd0.25dvars1.75_drpvls'
network_dir=paste0("~/Documents/projects/in_progress/within_between_network_conn_CBPD/data/imageData/",pipeline)
small <- new.env()
load(paste0(network_dir,"/CBPD_n83_schaefer400_allruns_FD0.5mmcensored0.2mmnooutliers.Rdata"), envir = small)
#take the participants that aren't in main_unique here and are in main_unique in the n=92 sample
excluded <- main_unique$ID[!(main_unique$ID %in% small$main_unique$ID)]
#take out the participants from main_excluded that are in the n=83 sample
main_excl <- main_exclude$ID[!(main_exclude$base_ID %in% small$main_unique$base_ID)]
IDs <- c(main_excl,excluded) %>% unique()
small_main_excluded <- main %>% filter(ID %in% IDs)
#small$main_excluded <- small$main %>% filter(., fd_mean_avg > 0.5)
#take only the first data we have from a subject
small_main_excluded$base_ID <- stri_split(small_main_excluded$record_id.y,fixed="_", simplify=T)[,1]
small_main_excluded$longitudinal_visit_num[is.na(small_main_excluded$longitudinal_visit_num)] <- 1
#only take one set of brain data from each participant, no matter the timepoint.
small_main_exclude <- small_main_excluded  %>% group_by(base_ID) %>% arrange(longitudinal) %>% filter(row_number() == 1)
dim(small_main_exclude) #it's 38 because there are 26 originally excluded, then 12 difference between n=92 and n=83 sample, but in the n=83 sample we saved 3 participants by using a second longitudinal scan.
#Remove those 3 participants
# small_main_exclude <- small_main_exclude %>% filter(!(base_ID %in% small$main_unique$base_ID))
# dim(small_main_exclude)
options(digits=2)
age_of_excluded_participants_small <- apa_print(t.test(small_main_exclude$age_scan, small$main_unique$age_scan))
#wilcox.test(small_main_exclude$age_scan, small_main_unique$age_scan)

small_main_exclude$matrix_reasoning_both <- ifelse(is.na(small_main_exclude$wppsi_matrix_valid),small_main_exclude$wisc_matrix_scaled,ifelse(small_main_exclude$wppsi_matrix_valid==0,NA,small_main_exclude$wppsi_matrix_scaled))
small_main_exclude$matrix_reasoning_both_raw <- ifelse(is.na(small_main_exclude$wppsi_matrix_valid),small_main_exclude$wisc_matrix_raw,ifelse(small_main_exclude$wppsi_matrix_valid==0,NA,small_main_exclude$wppsi_matrix_raw))
small_main_exclude$matrix_reasoning_both;small_main_exclude$matrix_reasoning_both_raw
small$main_unique$matrix_reasoning_both <- ifelse(is.na(small$main_unique$wppsi_matrix_valid),small$main_unique$wisc_matrix_scaled,ifelse(small$main_unique$wppsi_matrix_valid==0,NA,small$main_unique$wppsi_matrix_scaled))
small$main_unique$matrix_reasoning_both_raw <- ifelse(is.na(small$main_unique$wppsi_matrix_valid),small$main_unique$wisc_matrix_raw,ifelse(small$main_unique$wppsi_matrix_valid==0,NA,small$main_unique$wppsi_matrix_raw))
small$main_unique$matrix_reasoning_both;small$main_unique$matrix_reasoning_both_raw

reasoning_of_excluded_participants_small <- apa_print(t.test(small_main_exclude$matrix_reasoning_both, small$main_unique$matrix_reasoning_both)) #wilcox.test(small_main_exclude$matrix_reasoning_both, small_main_unique$matrix_reasoning_both)
```

The Institutional Review Board at the University of Pennsylvania approved this study. All parents provided informed, written consent. Children younger than age 8 provided verbal assent, and children ages 8 and older provided written assent. Participants were recruited from Philadelphia and the surrounding regions through advertisements on public transportation, partnerships with local schools, outreach programs, community family events, and social media ads. Children were between the ages of 4 and 10.59 years ($M =$ `r mean_age`, $SD =$ `r sd_age`). We chose to collect data from children starting at 4 years of age, as collecting functional brain imaging data from awake children younger than 4 may result in large amounts of unusable data. Parents were asked to report their child's gender and were provided four sex categories: female, male, other, and prefer not to answer. We recognize that the wording of this question conflated sex and gender, making it impossible for us to investigate the relation between brain development and the child's gender identity, whether within or outside the binary. `r round(female_perc)`% of children were reported by parents to be male and `r round(male_perc)`% were reported by parents to be female; none were reported to be other, suggesting that we might not have any intersex children in our sample. The racial and ethnic makeup of the sample was as follows: 61% Black, 36% white, 20% Asian, 8% other, and 10% Hispanic/Latino. Percentages sum to greater than 100% because parents or guardians could endorse multiple races. 49% of children had a parent with a college degree or more education and 45% had an annual family income of \$50,000 or more. <span custom-style="BlueColor">For comparison, Philadelphia was 43.6 % Black, 44.8 % White, 7.8 % Asian, 3.9 % Other, and 15.2 % Hispanic or Latino in 2020, and the median household income was $49,127 (US Census Bureau, 2020).</span>

The target sample size was 123 children with usable data to detect correlations of $r = .25$ with a power of greater than .8. However, data usability in young children can be difficult to predict, and data collection was cut short in 2020 by the COVID-19 pandemic. Resting-state scans were acquired for 138 participants. Ninety-two participants were included in the final sample. Participants were excluded for not completing the resting-state scan (e.g., due to falling asleep or wanting to end the scan early, $n = 17$), or parent-reported diagnosis of Attention-Deficit/Hyperactivity Disorder or developmental delay during the visit, despite not reporting a diagnosis during screening ($n = 4$). <div custom-style="BlueParagraph">To mitigate the effect of image quality on our analyses, we also employed motion and quality exclusions. We excluded children with average framewise displacement (FD) \> 1 mm ($n = 14$), and we censored volumes at 0.5 mm FD. We further excluded children with \> 30% of frames exceeding 0.5 mm FD ($n = 8$, @power_spurious_2012-1) or artifacts ($n = 3$, see below for details). These criteria were selected to balance the need to include as much data as possible in a young population [@leonardHowMuchMotion2017] and the need to limit the influence of low-quality data on connectivity metrics [@power_methods_2014]. Separately, we conducted an additional sensitivity analysis with stricter motion cutoffs: excluding children with \> 0.5 mm average FD ($n = 9$) and censoring volumes with \> 0.25 mm FD. 

A total of 25 children were excluded for image artifacts or motion in the original sample. At the more lenient threshold, these children were younger than the included children (`r age_of_excluded_participants$statistic`), but not different on age-normed reasoning scores (`r reasoning_of_excluded_participants$statistic`). At the stricter threshold, 34 children were excluded for image artifacts or motion: excluded children were younger than the included children (`r age_of_excluded_participants_small$statistic`), but not different on age-normed reasoning scores (`r reasoning_of_excluded_participants_small$statistic`).</div>

## Data acquisition

Prior to the scanning session, participants were acclimated to the scanning environment with a mock scanner that simulates typical MRI noises. Participants practiced keeping still in the mock scanner, by watching a movie that would pause each time they moved their heads more than 1 mm. During the MRI session, a researcher stayed in the scanner room with the participant to reassure the child. Participants viewed a fixation cross on a gray screen throughout the resting-state scan. 

<span custom-style="BlueColor">Imaging was performed at the Center for Advanced Magnetic Resonance Imaging and Spectroscopy (CAMRIS) at the University of Pennsylvania. Scanning was conducted using a Siemens MAGNETOM Prisma 3 T MRI scanner with the vendor’s 32-channel coil. </span>5-minute resting-state fMRI scans were acquired using a T2\*-weighted multiband gradient-echo echo-planar imaging (EPI) sequence (TR = 2000 ms, TE = 30.2 ms, BW = 1860 Hz/px, flip angle = 90◦, voxel size = 2 mm isotropic, matrix size = 96 × 96, 75 axial slices, FOV = 192 mm, volumes = 150--240, 5 dummy scans, multiband acceleration factor = 3). We chose a multiband factor of 3 to minimize interactions between multiband and motion [@risk_which_2021]. A whole-brain, high-resolution, T1-weighted 3D-encoded multi-echo anatomical image (MEMPRAGE) was acquired (TR = 2530 ms, TEs = 1.69 ms/3.55 ms/5.41 ms/7.27 ms, BW =650 Hz/px, 3x GRAPPA, flip angle = 7◦, voxel size =1 mm isotropic, matrix size = 256 × 256, 176 sagittal slices, FOV =256 mm, total scan time of 4:38 minutes). This anatomical sequence used interleaved volumetric navigators to prospectively track and correct for subject head motion [@tisdall_volumetric_2012].

To increase the amount of usable data, midway through data collection, we updated our acquisition strategy in two ways: (i) monitoring head motion in real-time using the Framewise Integrated Real-time MRI Monitor (FIRMM) system [@dosenbach_real-time_2017], and (ii) collecting 10 minutes of low-motion resting-state data (2 resting-state runs of data with FD \< 1 mm) when possible.<span custom-style="BlueColor"> An incidental feature of this design choice is that it decouples age, and reasoning ability, from the amount of data acquired for each child.</span> One scan was acquired for 43 children, two scans were acquired for 48 children, and three scans were acquired for one child. Participants were eligible for inclusion if they had more than 135 frames of resting-state data. Participants had an average FD of `r mean(main_unique$fd_mean_avg)` mm ($SD =$ `r sd(main_unique$fd_mean_avg)` mm). For participants with more than one usable resting-state run, we took an average of FD across runs, weighted by run length. All analyses controlled for average FD and total number of resting-state frames collected.

## Image preprocessing 
Results included in this manuscript come from preprocessed data, where the preprocessing was performed using Freesurfer [@dale_cortical_1999-1], fMRIPprep 1.2.6-1 (@esteban_fmriprep:_2018; @esteban_nipreps_2019; RRID:SCR_016216), which is based on Nipype 1.1.7 (@gorgolewski_krzysztof_j_2017_581704; @nipype1; RRID:SCR_002502), as well as xcpEngine 1.0 [@ciric_mitigating_2018]. Brain surfaces were reconstructed using recon-all [@dale_cortical_1999-1] prior to other processing, and reconstructed surfaces were used as input to fMRIprep.   

The T1-weighted (T1w) image was corrected for intensity non-uniformity (INU) using N4BiasFieldCorrection (@n4, ANTs 2.2.0), and used as T1w-reference throughout the workflow. The T1w-reference was then skull-stripped using antsBrainExtraction.sh (ANTs 2.2.0), using OASIS as the target template. The brain mask was refined with a custom variation of the method to reconcile ANTs-derived and FreeSurfer-derived segmentations of the cortical gray-matter of Mindboggle (RRID:SCR_002438, @mindboggle). Spatial normalization to the ICBM 152 Nonlinear Asymmetrical template version 2009c (@mni152nlin2009casym, RRID:SCR_008796) was performed through nonlinear registration with antsRegistration (ANTs 2.2.0, RRID:SCR_004757, @avants_optimal_2010), using brain-extracted versions of both T1w volume and template. Brain tissue segmentation of cerebrospinal fluid (CSF), white matter (WM) and gray matter was performed on the brain-extracted T1w using fast (FSL 5.0.9, RRID:SCR_002823, @fsl_fast).    

For each of the resting-state BOLD runs found per subject, the following preprocessing was performed: A reference volume and its skull-stripped version were generated using a custom methodology of fMRIPrep. The BOLD reference was then co-registered to the T1w reference using bbregister (FreeSurfer) which implements boundary-based registration [@greve_accurate_2009]. Co-registration was configured with nine degrees of freedom to account for distortions remaining in the BOLD reference. Head-motion parameters with respect to the BOLD reference (transformation matrices, and six corresponding rotation and translation parameters) were estimated before any spatiotemporal filtering using mcflirt (FSL 5.0.9, @jenkinson_improved_2002). BOLD runs were slice-time corrected using 3dTshift from AFNI 20160207 (@afni, RRID:SCR_005927). The BOLD time-series were resampled onto MNI152NLin2009cAsym standard space by applying a single, composite transform, generating a preprocessed BOLD run in MNI152NLin2009cAsym space.   

Several confounding time-series were calculated based on the preprocessed BOLD: framewise displacement (FD), DVARS and three region-wise global signals (CSF, WM, and the whole-brain). FD and DVARS were calculated for each functional run, both using their implementations in Nipype (following the definitions by @power_fd_dvars). The head-motion estimates calculated in the correction step were also placed within the corresponding confounds file.   

All resamplings can be performed with a single interpolation step by composing all the pertinent transformations (i.e. head-motion transform matrices and co-registrations to anatomical and template spaces). Gridded (volumetric) resamplings were performed using antsApplyTransforms (ANTs), configured with Lanczos interpolation to minimize the smoothing effects of other kernels [@lanczos].  

Further preprocessing was performed using a confound regression procedure that has been optimized to reduce the influence of participant motion [@ciric_benchmarking_2017; @parkes_evaluation_2018; @satterthwaite_heterogeneous_2013]; preprocessing was implemented in XCPEngine 1.0, a multi-modal toolkit that deploys processing instruments from frequently used software libraries, including FSL [@jenkinson_fsl_2012] and AFNI [@cox_afni:_1996]. Further documentation is available at https://xcpengine.readthedocs.io and https://github.com/PennBBL/xcpEngine. Functional timeseries were demeaned, and linear and quadratic trends were removed. Confound regression was performed using a 36-parameter model; confounds included mean signal from the whole brain, WM, and CSF compartments, 6 motion parameters as well as their temporal derivatives, quadratic terms, and the temporal derivatives of the quadratic terms [@satterthwaite_improved_2013]. Motion censoring was applied, with outlier volumes exceeding FD = 0.5 mm or standardized DVARS = 1.75 flagged and removed from confound regression. Outlier volumes were interpolated over using least squares spectral analysis [@power_methods_2014] prior to band-pass filtering to retain frequencies between 0.01 Hz and 0.08 Hz, then re-censored. Prior to confound regression, all confound parameters were band-pass filtered in a fashion identical to that applied to the original timeseries data, ensuring comparability of the signals in frequency content [@hallquist_nuisance_2013]. 

## Image quality and exclusion criteria
The quality of imaging data was assessed using fMRIPrep’s visual reports and MRIQC 0.14.2 [@esteban_mriqc:_2017]. <span custom-style="BlueColor"> Two raters manually examined all structural and functional images between preprocessing steps for image quality issues.</span> Functional images were visually inspected for whole-brain field of view coverage, signal blurring or artifacts, and proper alignment to the anatomical image. Participants were excluded for: unusable anatomical image (n = 1), artifact in functional data (due to hair glitter, $n = 1$), incorrect registration at the scanner ($n = 1$), average FD greater than 1 mm ($n = 14$), more than 30% of resting-state frames exceeding FD > 0.5 mm ($n = 8$, @power_spurious_2012-1). <span custom-style="BlueColor"> All participants that were flagged for dropout or signal blurring were ultimately excluded for not meeting motion criteria.</span> For participants with more than one usable resting-state run, FD was averaged across runs, weighted by run length. All analyses controlled for average FD and total number of resting-state frames. 

<div custom-style="BlueParagraph">To ensure that our results were not driven by motion, we conducted an additional analysis with a more stringent preprocessing pipeline and motion exclusion criteria. In this pipeline, motion censoring was applied with a threshold for outlier volumes of FD > 0.25 mm or standardized DVARS > 1.75. One participant was excluded during preprocessing as they did not have adequate degrees of freedom. Additionally, we excluded participants who had average FD greater than 0.5 mm ($n=8$ additional participants), for a total of $n=83$ total participants.</div>

## Functional network analysis

After preprocessing and nuisance regression,<span custom-style="BlueColor"> we extracted</span> residual mean BOLD time series from a 400-region cortical parcellation [@schaefer_local-global_2018], <span custom-style="BlueColor">and represented the functional connectivity matrix as a graph or network [@bassett_nature_2018]</span>. To evaluate whether our results were dependent on specific node definitions, we also extracted residual mean BOLD time series from a 200-region cortical parcellation [@schaefer_local-global_2018]. Results were qualitatively similar between the two parcellations (see online at <https://github.com/utooley/Tooley_2022_childhood_functional_network_dev>).

We assigned regions, or nodes, to systems based on a 7-system partition [@yeo_organization_2011], or assignment of nodes to systems. Here, we use the term *system* to refer to a set of regions previously defined *a priori* (i.e. the dorsal attention system, comprising a set of regions), while we use the term *network* to refer to the representation of the functional connectivity matrix as a graph. <span custom-style="BlueColor">Regions were represented by network nodes, and the functional connectivity between region $i$ and region $j$ was represented by the network edge between node $i$ and node $j$. We used this encoding of the data as a network to produce an undirected, signed, and weighted adjacency matrix $A$.</span>  We estimated the functional connectivity between any two brain regions by calculating the product-moment correlation coefficient $r$ between the mean activity time series of region $i$ and the mean activity time series of region $j$ [@zalesky_use_2012]. Correlations were subsequently $r$-to-$z$-transformed.

Recent evidence has demonstrated that the maintenance of edge weights is critical for an accurate understanding of the underlying biology of neural systems [@bassett_small-world_2017; @cole_global_2012], and work in applied mathematics has demonstrated that graph-related calculations are markedly more robust in weighted graphs than in binary graphs [@good_performance_2010]. In light of these two lines of evidence and recent work in the field developing methods sensitive to the topologies present in weak versus strong edges [@rubinov_weight-conserving_2011], we maintained all edge weights without thresholding and studied the full graph including both positive and negative correlations [@bassett_altered_2012; @santarnecchi_efficiency_2014]. Functional connectivity matrices were averaged across runs for each participant, weighted by the number of frames in each run passing the quality threshold.

Across the cortex, we calculated the following summary functional network measures. *System segregation* is a measure of segregation that quantifies the difference between mean within-system connectivity and mean between-system connectivity as a proportion of mean within-system connectivity [@chan_decreased_2014; @wig_segregated_2017], given an *a priori* partition of nodes into systems<span custom-style="BlueColor">, in this case the 7-system partition referenced earlier [@yeo_organization_2011]</span>. *Modularity*, quantified by the modularity quality index (*Q*), is a measure of mesoscale network segregation that estimates the extent to which a network's nodes can be subdivided into groups or "modules" characterized by strong, dense intramodular connectivity and weak, sparse intermodular connectivity. Our approach is built on the modularity quality function originally defined in @newman_modularity_2006. Unlike system segregation, the modularity quality index is independent of a mapping of nodes to functional systems. Higher modularity is indicative of a more highly segregated network at the mesoscale. The *clustering coefficient* is a measure of local segregation that quantifies the amount of connectivity between a node and its strongest neighbors [@achard_resilient_2006; @bartolomei_disturbed_2006; @bassett_adaptive_2006; @xu_representing_2016]. A node has a high clustering coefficient when a high proportion of its neighbors are also strong neighbors of each other. The *participation coefficient* quantifies the diversity of a node's connections across systems [@guimera_functional_2005; @rubinov_complex_2010]. A node has a high participation coefficient when it is evenly and strongly connected to many different systems. A lower participation coefficient is indicative of a more highly segregated network. We specifically chose measures of functional network topology that were suitable for weighted, signed networks, when possible.

## <span custom-style="BlueColor">System segregation</span>
<div custom-style="BlueParagraph">System segregation quantifies the difference in mean within-system connectivity and mean between-system connectivity as a proportion of within-system connectivity. Previous work has linked this measure to aging-related changes in brain networks and poorer cognitive ability across age [@chan_decreased_2014]. In these analyses, we define system segregation as in [@chan_decreased_2014], as:
$$
\frac{\bar a_{within}- \bar a_{between}}{\bar a_{within}}
$$
Where $\bar a_{within}$ is the mean edge weight between nodes within the same system and $\bar a_{between}$ is the mean edge weight between nodes of one system to all nodes in other systems. We assigned nodes to systems based on a 7-system partition [@yeo_organization_2011]. Freely available MATLAB code from https://github.com/mychan24/system_matrix_tools was used to calculate system segregation.


## <span custom-style="BlueColor">Modularity quality index</span>
Statistics that quantify the modular structure of a network assess the extent to which a network’s nodes can be subdivided into groups or modules characterized by strong, dense intramodular connectivity and weak, sparse intermodular connectivity. We considered the most commonly studied mesoscale organization—assortative community structure—that is commonly assessed by maximizing a modularity quality function [@fortunato_community_2010; @porter_communities_2009]. Our approach is built on the modularity quality function originally defined by Newman [@newman_modularity_2006] and subsequently extended to weighted and signed networks by various groups.   

Specifically, we follow Rubinov and Sporns (2011) by first letting the weight of a positive connection between nodes $i$ and $j$ be given by $a^+_{ij}$ , the weight of a negative connection between nodes $i$ and $j$ be given by ${a^−}_{ij}$ , and the strength of a node $i$, $s^\pm_i = \sum_j a^{\pm_{ij}}$, be given by the sum of the positive or negative $j$ connection weights of $i$. We denote the chance expected within-module connection weights as $e^+_{ij}$ for positive weights and $e^-_{ij}$ for negative weights, where $e^\pm_{ij} = \frac {s^\pm_i s^\pm_j}{v^\pm}$. We let the total weight $v^\pm = \sum_{ij} a^\pm_{ij}$ be the sum of all positive or negative connection weights in the network. Then the asymmetric generalization of the modularity quality index is given by:
$$
Q^* = \frac{1}{v^+} \sum_{ij}(a^+_{ij} - e^+_{ij}) \delta_{M_i M_j} - \frac{1}{v^+ + v^-} \sum_{ij}(a^-_{ij} - e^-_{ij}) \delta_{M_i M_j}~
$$
where $M_i$ is the community to which node $i$ is assigned, and $M_j$ is the community to which node $j$ is assigned. We use a Louvain-like locally greedy algorithm as a heuristic to maximize this modularity quality index subject to a partition M of nodes into communities. We ran the Louvain algorithm 100 times per network, and detected on average 3 (M=3.44, SD =0.483) communities using modularity maximization in our developmental sample.

## <span custom-style="BlueColor">Clustering coefficient</span>

To assess local network segregation, we used a commonly studied graph measure of local connectivity—the clustering coefficient— that is commonly interpreted as reflecting the capacity of the system for processing within the immediate neighborhood of a given network node [@achard_resilient_2006; @bartolomei_disturbed_2006; @bassett_small-world_2006; @xu_network_2016]. We specifically used a formulation that was recently generalized to signed weighted networks [@costantini_generalization_2014; @zhang_general_2005]. This version is sensitive to nonredundancy in path information based on edge sign as well as edge weight and importantly distinguishes between positive triangles and negative triangles, which have distinct meanings in networks constructed from correlation matrices.  

Let the functional connectivity network of a single participant be represented as the graph $G = (V, E)$, where $V$ and $E$ are the vertex and edge sets, respectively. Let $a_{ij}$ be the weight associated with the edge $(i,j) \in V$, and define the weighted adjacency matrix of $G$ as $A = [a_{ij}]$. The clustering coefficient of node $i$ with neighbors $j$ and $q$ is given by
$$
C_i =  \frac{\sum_{jq} (a_{ji} a_{iq} a_{jq}) }
{\sum_{j \neq q} | a_{ji} a_{iq} |}~~
$$
The clustering coefficient of the entire network was calculated as the average of the clustering coefficient across all nodes as follows:
$$
C = \frac{1}{n} \sum_{i \in N} C_i~~
$$
In this way, we obtained estimates of the regional and global clustering coefficient for each subject in the sample.

## <span custom-style="BlueColor">Participation coefficient</span>
The participation coefficient is a measure of network integration that quantifies the diversity of a node’s connections across communities, and has been linked in older children and adolescents to developmental changes in network segregation [@baum_modular_2017; @marek_contribution_2015]. In these analyses, we define the participation coefficient $P_i$ of a node $i$ as:
$$
P_i = 1 - \sum_{k \in K} (\frac{a_{ik}}{s_i})
$$
where $k$ is a system in a set $K$ of systems, in this case defined by the a priori mapping of nodes to intrinsic functional systems [@yeo_organization_2011], $a_{ik}$ is the positive (negative) weight of edges between node $i$ and nodes in system $k$, and $s_i$ is the positive (negative) strength of node i. The participation coefficient was calculated separately on negative and positive weights [@rubinov_complex_2010].  

As in our analyses of local segregation, the participation coefficient of the entire network was calculated as the average positive (negative) participation coefficient across all nodes as follows:
$$
P = \frac{1}{n} \sum_{i \in N} P_i
$$
The average positive and negative participation coefficient for each participant’s network were averaged to obtain a global measure of network integration.</div>

## System connectivity

Within- and between-system connectivity were estimated as the average connectivity between nodes within a functional system or between pairs of functional systems. Results were corrected for multiple comparisons using the Benjamini-Hochberg false discovery rate (FDR).

## Parcel-level connectivity

When examining results at the parcel resolution, we applied a similar model as that at the whole-brain and system level across all 79,800 edges in each child's functional brain network. As correction for multiple comparisons in this situation raises the risk of missing true effects, we alternatively employed a stringent significance threshold for display of edge-level data ($p < 0.001$). Data are presented at $p < .01$ and at $p < .00001$<span custom-style="BlueColor"> online at <https://github.com/utooley/Tooley_2022_childhood_functional_network_dev></span>.

## Statistical models

All statistical analyses were conducted in MATLAB R2018a and R 3.6.1 [\@MATLAB:2018a; @r_core_team_r_2013]; code is publicly available at <https://github.com/utooley/Tooley_2022_childhood_functional_network_dev>. We examined effects of age using generalized additive models with the *mgcv* package in R [@satterthwaite_impact_2014; @wood_fast_2011]. We first tested for nonlinear effects of age. The penalty parameters for the nonlinear spline terms were fit as random effects and tested using restricted likelihood ratio tests (RLRTs) with *RLRsim* [@scheipl_size_2008]. Note that these tests of nonlinearity are constructed so as to test for nonlinear effects over and above any linear effects that may be present. We did not observe significant nonlinear relationships between age and whole-brain or system-level measures of network structure. 7.9% of edges showed significant nonlinear effects of age, as compared to 12.5% of edges that showed linear effects. Nonlinear effects at the parcel level are presented <span custom-style="BlueColor">online at <https://github.com/utooley/Tooley_2022_childhood_functional_network_dev></span>.

We modeled the linear effect of age while controlling for in-scanner motion (average FD), sex (male or female), total number of volumes across runs, and average functional network weight. Average network weight was included to control for global differences in connectivity strength [@ginestet_brain_2011; @van_wijk_comparing_2010; @yan_standardizing_2013]. Multiple comparisons correction was applied across models at the parcel and system resolutions using Benjamini-Hochberg false discovery rate (FDR) correction [@benjamini_controlling_1995]. Surfaces and partitions were shown on cortical surfaces generated by Freesurfer [@dale_cortical_1999-1], using *fsbrain* 0.4.2 and *freesurfer-formats* 0.1.14 [@schafer_fsbrain_2020].

## Measurement and analyses of visuospatial reasoning ability

```{r age correlations with reasoning, include= F, echo= F}
age_and_wppsi <- apa_print(cor.test(main_unique$wppsi_matrix_raw, main_unique$age_scan))
age_and_wisc <- apa_print(cor.test(main_unique$wisc_matrix_raw, main_unique$age_scan))
warnings()
```

To assess reasoning, we administered<span custom-style="BlueColor"> matrix </span>reasoning tests from Wechsler batteries. <span custom-style="BlueColor">We used age-appropriate versions to avoid ceiling and floor effects.</span> Children between the ages of 4 and 7 years, 7 months completed the Matrix Reasoning subtest of the Wechsler Preschool & Primary Scale of Intelligence (WPPSI-IV, @wechsler_wppsiiv_2012; $n = 63$). Children over age 7 years, 7 months took the Matrix Reasoning subtest of the Wechsler Intelligence Scale for Children (WISC, @wechsler_wiscv_2014; $n = 23$). <span custom-style="BlueColor">Test items in both versions require the participant to identify and integrate patterns in abstract shapes. For example, in Figure 4a, the foreground and background shapes switch across columns, and the shape type and color change across rows. To answer the question correctly, it is necessary to integrate these two relations. The WPPSI is normed down to 2.5 years old so it begins with simpler items than the WISC. Therefore, raw scores on the WPPSI cannot be combined with raw scores on the WISC.</span> Age was positively associated with raw scores on the WPPSI (<span custom-style="BlueColor">mean raw score: `r mean(main_unique$wppsi_matrix_raw, na.rm=T)`, range `r min(main_unique$wppsi_matrix_raw, na.rm=T)`-`r max(main_unique$wppsi_matrix_raw, na.rm=T)`, maximum possible score: 26</span>, `r age_and_wppsi$statistic`). Age was not associated with raw scores on the WISC (<span custom-style="BlueColor">mean raw score: `r mean(main_unique$wisc_matrix_raw, na.rm=T)`, range `r min(main_unique$wisc_matrix_raw, na.rm=T)`-`r max(main_unique$wisc_matrix_raw, na.rm=T)`, maximum possible score: 32</span>, `r age_and_wisc$statistic`). Scaled scores were used for all brain analyses. Models examining relationships between reasoning and system connectivity controlled for age, sex, in-scanner motion, total number of volumes across runs, and average functional network weight. Associations between system connectivity and reasoning ability were examined only for systems showing significant associations with age and the frontoparietal system (FDR-corrected for multiple comparisons across 5 systems).

# Results

## Functional network segregation increases with age

```{r Segregation + age, include=FALSE, echo=FALSE}
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome,"_age")
  formula<-formula(paste0(outcome, '~age_scan+male+fd_mean_avg+avgweight+totalSizet'))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(summary(get(model)), ))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_",model)
  assign(beta, lm.beta(get(model)))
}
#Correct across
covariates="~age_scan+male+fd_mean_avg+avgweight+totalSizet"
#make a dataframe with no repeats of net comparisons
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
#run and correct for multiple comparisons again
m <- mclapply(outcomes, function(sys) {as.formula(paste(sys,covariates, sep=""))},mc.cores=2)
networks_segreg_measures_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[2,4]},mc.cores=1)
networks_segreg_measures_pvals <- as.data.frame(networks_segreg_measures_pvals)
networks_segreg_measures_pvals <- t(networks_segreg_measures_pvals)
networks_segreg_measures_pvals <- as.data.frame(networks_segreg_measures_pvals)
#FDR correct
networks_segreg_measures_pvals_fdr <- cbind(networks_segreg_measures_pvals,data.frame(p.adjust(networks_segreg_measures_pvals$V1, method="fdr")))
networks_segreg_measures_pvals_fdr <- data.frame(networks_segreg_measures_pvals_fdr,rep(outcomes,1))
colnames(networks_segreg_measures_pvals_fdr) <- c("pvalue", "corrected_pvalue","measure")
networks_segreg_measures_pvals_fdr #Corrected for 6 tests!
```

We first investigated age effects on measures of whole-brain functional network segregation (Fig. 1). Measures of functional network segregation were consistently positively associated with age, including average within-system connectivity ($\beta =$ `r beta_lm_mean_within_sys_age$standardized.coefficients[2]`, `r  summary_lm_mean_within_sys_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="mean_within_sys"], digits=4)`), average between-system connectivity ($\beta =$ `r beta_lm_mean_between_sys_age$standardized.coefficients[2]`, `r  summary_lm_mean_between_sys_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="mean_between_sys"], digits=4)`), overall system segregation ($\beta =$ `r beta_lm_system_segreg_age$standardized.coefficients[2]`, `r  summary_lm_system_segreg_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="system_segreg"], digits=4)`), the modularity quality index ($\beta =$ `r beta_lm_modul_avg_age$standardized.coefficients[2]`, `r  summary_lm_modul_avg_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="modul_avg"],digits=3)`), and the clustering coefficient ($\beta =$ `r beta_lm_avgclustco_both_age$standardized.coefficients[2]`, `r  summary_lm_avgclustco_both_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="avgclustco_both"],digits=3)`). Consistent with these associations, we found that the average participation coefficient, a measure that inversely tracks network segregation, was negatively correlated with age ($\beta =$ `r beta_lm_part_coef_age$standardized.coefficients[2]`, `r summary_lm_part_coef_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="part_coef"],digits=5)`).

![**Figure 1. Functional network segregation is positively associated with age. a.** System segregation is a whole-brain measure of functional network segregation that quantifies the difference between mean within-system connectivity and mean between-system connectivity as a proportion of mean within-system connectivity. **b.** System segregation is positively associated with age. **c.** Modularity is a measure of mesoscale network segregation that estimates the extent to which a network's nodes, or in this case brain regions, can be subdivided into modules characterized by strong, dense intramodular connectivity and weak, sparse intermodular connectivity. Note that the modules are data-driven, not a priori defined as functional systems. **d.** Modularity is positively associated with age. **e.** The clustering coefficient is a measure of local segregation that quantifies the amount of connectivity between a node and its neighbors. A node has a high clustering coefficient when a high proportion of its neighbors are also strongly connected to one another. In a weighted network, the clustering coefficient measures the strength of triangles around a node. **f.** The average clustering coefficient is positively associated with age. **g.** The participation coefficient quantifies the diversity of a node's connections across systems. A node has a high participation coefficient when it is evenly connected to many different systems. A lower participation coefficient is indicative of a more segregated network. **h.** The average participation coefficient is negatively associated with age.](ms_figures/new_figures/fig_1-01.png)

## Systems specializing in perceptual processing segregate from systems for abstract thought

```{r system-specific effects, include=FALSE, echo=FALSE}
networks_age_pvals_fdr #FDR-corrected
outcomes <- main_unique %>% ungroup() %>% dplyr::select(matches("sys.to.")) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome)
  formula<-formula(paste0(outcome, '~age_scan+male+fd_mean_avg+avgweight+totalSizet'))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(summary(get(model)), digits = 5))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_", model)
  assign(beta, lm.beta(get(model)))
}
beta_lm_sys7to7
# summary(lm_sys1to3);visreg(lm_sys1to3,"age_scan");lm.beta(lm_sys1to3)
# summary(lm_sys3to7);visreg(lm_sys3to7,"age_scan");lm.beta(lm_sys3to7)
# summary(lm_sys4to7);visreg(lm_sys4to7,"age_scan");lm.beta(lm_sys4to7)
# summary(lm_sys3to4);visreg(lm_sys3to4,"age_scan");lm.beta(lm_sys3to4)
```

We next tested for age effects at the system level by dividing the cortex into seven systems [@yeo_organization_2011]. We first visualized the balance of significant positive and negative age effects within and between systems (Fig. 2a). Within systems, 94.6% of significant age effects were positive and 5.3% were negative. Between systems, 27.7% of significant age effects were positive and 72.2% were negative. Age was positively, but weakly, associated with within-system connectivity in the visual (Fig. 2b, $\beta =$ `r beta_lm_sys1to1$standardized.coefficients[2]`, `r  summary_lm_sys1to1$statistic$age_scan`) and default mode systems ($\beta =$ `r beta_lm_sys7to7$standardized.coefficients[2]`, `r  summary_lm_sys7to7$statistic$age_scan`), as well as in the ventral attention system ($\beta =$ `r beta_lm_sys4to4$standardized.coefficients[2]`, `r  summary_lm_sys4to4$statistic$age_scan`). The significance of these associations did not survive correction for multiple comparisons. In contrast, age was strongly associated with between-system connectivity (Fig. 2c). Age was negatively associated with connectivity between the default mode and dorsal attention systems ($\beta =$ `r beta_lm_sys3to7$standardized.coefficients[2]`, `r  summary_lm_sys3to7$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys3to7"]`), and connectivity between the default mode and ventral attention systems ($\beta =$ `r beta_lm_sys4to7$standardized.coefficients[2]`, `r  summary_lm_sys4to7$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys4to7"]`). Additionally, age was positively correlated with connectivity between the visual and dorsal attention systems ($\beta =$ `r beta_lm_sys1to3$standardized.coefficients[2]`, `r  summary_lm_sys1to3$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys1to3"]`) and with connectivity between the dorsal attention and ventral attention systems ($\beta =$ `r beta_lm_sys3to4$standardized.coefficients[2]`, `r  summary_lm_sys3to4$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys3to4"]`).

![**Figure 2. System-level effects of age on system connectivity. a.** Age effects on edge connectivity. Note that only edges with significant age effects at $p_{unc} < 0.001$ are shown. **b.** Age effects on within-system connectivity. No relationships survive FDR correction across systems. **c.** Age effects on between-system connectivity. All effects shown survive FDR correction across systems.](ms_figures/new_figures/fig_2-01.png)

## Age effects are concentrated at both ends of the sensory-association gradient

```{r edge-level effects, include= F, echo=F}
## Edge-level analyses see manuscript_analyses.R file
```

We next examined age effects at the parcel level to characterize regional specificity. In particular, we determined which parcels had the most edges with significant age effects. Parcels with the highest number of positive edge-level age effects were observed in the intraparietal sulcus (2 parcels with 9 significant edges), the medial prefrontal cortex (7 edges), and the occipital cortex (6 edges; see Fig. 3a). When parcels were grouped by system [@yeo_organization_2011], positive associations with age were most common in the visual system, followed by the default mode system, and the ventral attention system (Fig. 3b). Parcels with negative edge-level age effects were also concentrated in the medial prefrontal cortex and the intraparietal sulcus, but not in lower-level sensory or motor areas (Fig. 3c)<span custom-style="BlueColor">. Edge-level age effects were most pronounced in a medial prefrontal cortex parcel in the default mode system (top parcel: medial prefrontal cortex, 13 negative age-associated edges). The top five non-anatomical meta-analytic associations on Neurosynth for the medial prefrontal cortex region (MNI coordinates of centroid: x = 8, y = 54, z = 12) were "mind," "theory mind," "autobiographical," "mentalizing," and "mental states".</span> Negative associations with age were most common in the default mode system and the ventral attention system, followed by the dorsal attention and frontoparietal systems. Very few negative associations were found in the visual, somatomotor, or limbic systems (Fig. 3d).

![**Figure 3. Parcel-level effects of age on network connectivity. a.** Number of edges from each parcel showing a significant positive age association; significance was defined as $p_{unc} < 0.001$. **b.** Number of edges with positive effects of age, grouped by system. Each datapoint represents a parcel. **c.** Number of edges from each parcel showing a significant negative age association; significance was defined as $p_{unc} < 0.001$. **d.** Negative edge effects for each parcel grouped by system. Each datapoint represents a parcel.](ms_figures/new_figures/fig_3-no-nodal-strength-01.png)

## Functional network structure is associated with cognition

```{r network structure to reasoning, echo=F, include=F}
main_unique$matrix_reasoning_both <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_scaled,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_scaled))
main_unique$matrix_reasoning_both_raw <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_raw,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_raw))
main_unique$matrix_reasoning_both;main_unique$matrix_reasoning_both_raw

mr <- lm(matrix_reasoning_both_raw~age_behav.x, data=main_unique)
summary(mr)

#Test measures of segregation with reasoning
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome,"_reasoning")
  formula<-formula(paste0('matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+',outcome))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(Anova(get(model)), es="pes",mse=FALSE))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_",model)
  assign(beta, lm.beta(get(model)))
  print(outcome)
  print(summary(get(model)))
}

#Correct across
covariates="matrix_reasoning_both~ age_scan+male+fd_mean_avg+avgweight+totalSizet+"
#make a dataframe with no repeats of net comparisons
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
#run and compare for multiple comparisons again
m <- mclapply(outcomes, function(sys) {as.formula(paste(covariates, sys,sep=""))},mc.cores=2)
networks_reasoning_measures_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[7,4]},mc.cores=1)
networks_reasoning_measures_pvals <- as.data.frame(networks_reasoning_measures_pvals)
networks_reasoning_measures_pvals <- t(networks_reasoning_measures_pvals)
networks_reasoning_measures_pvals <- as.data.frame(networks_reasoning_measures_pvals)
#FDR correct
networks_reasoning_measures_pvals_fdr <- cbind(networks_reasoning_measures_pvals,data.frame(p.adjust(networks_reasoning_measures_pvals$V1, method="fdr")))
networks_reasoning_measures_pvals_fdr <- data.frame(networks_reasoning_measures_pvals_fdr,rep(outcomes,1))
colnames(networks_reasoning_measures_pvals_fdr) <- c("pvalue", "corrected_pvalue","measure")
networks_reasoning_measures_pvals_fdr #Corrected for 6 tests!

#Test all 4 age-sig systems with Reasoning
lm_reasoning_sys1to3<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique)
lm_reasoning_sys3to7<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique)
lm_reasoning_sys4to7<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys4to7, data=main_unique)
lm_reasoning_sys3to4<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to4, data=main_unique)
summary_lm_reasoning_sys1to3 <- apa_print(summary(lm_reasoning_sys1to3));beta_lm_reasoning_sys1to3 <- lm.beta(lm_reasoning_sys1to3)
eta_lm_reasoning_sys1to3 <- eta_squared(Anova(lm_reasoning_sys1to3), ci=0.95);cohensf_lm_reasoning_sys1to3 <- cohens_f(Anova(lm_reasoning_sys1to3), ci=0.95)
summary_lm_reasoning_sys3to7 <- apa_print(summary(lm_reasoning_sys3to7));beta_lm_reasoning_sys3to7 <- lm.beta(lm_reasoning_sys3to7)
eta_lm_reasoning_sys3to7 <- eta_squared(Anova(lm_reasoning_sys3to7), ci=0.95);cohensf_lm_reasoning_sys3to7 <- cohens_f(Anova(lm_reasoning_sys3to7), ci=0.95)
summary_lm_reasoning_sys4to7 <- apa_print(summary(lm_reasoning_sys4to7));beta_lm_reasoning_sys4to7 <- lm.beta(lm_reasoning_sys4to7)
eta_lm_reasoning_sys4to7 <- eta_squared(Anova(lm_reasoning_sys4to7), ci=0.95);cohensf_lm_reasoning_sys4to7 <- cohens_f(Anova(lm_reasoning_sys4to7), ci=0.95)

lm_reasoning_sys6to6<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys6to6, data=main_unique)
summary_lm_reasoning_sys6to6 <- apa_print(summary(lm_reasoning_sys6to6));beta_lm_reasoning_sys6to6 <- lm.beta(lm_reasoning_sys6to6)

#Correct across
covariates="matrix_reasoning_both~ age_scan+male+fd_mean_avg+avgweight+totalSizet+"
#make a dataframe with no repeats of net comparisons
nets <- dplyr::select(main_unique, sys1to3,sys3to7,sys4to7,sys3to4, sys6to6) %>% ungroup %>% names()
nets <- nets[-1]
#run and compare for multiple comparisons again
m <- mclapply(nets, function(sys) {as.formula(paste(covariates, sys,sep=""))},mc.cores=2)
networks_reasoning_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[7,4]},mc.cores=1)
networks_reasoning_pvals <- as.data.frame(networks_reasoning_pvals)
networks_reasoning_pvals <- t(networks_reasoning_pvals)
networks_reasoning_pvals <- as.data.frame(networks_reasoning_pvals)
#FDR correct
networks_reasoning_pvals_fdr <- cbind(networks_reasoning_pvals,data.frame(p.adjust(networks_reasoning_pvals$V1, method="fdr")))
networks_reasoning_pvals_fdr <- data.frame(networks_reasoning_pvals_fdr,rep(nets,1))
colnames(networks_reasoning_pvals_fdr) <- c("pvalue", "corrected_pvalue","network")
networks_reasoning_pvals_fdr #Corrected for 5 tests!

#Test 2 sig systems with Reasoning in separate samples
lm_reasoning_sys1to3<- lm(wisc_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique);summary(lm_reasoning_sys1to3)
lm_reasoning_sys1to3<- lm(wppsi_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique);summary(lm_reasoning_sys1to3)
lm_reasoning_sys3to7<- lm(wisc_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique);summary(lm_reasoning_sys3to7)
lm_reasoning_sys3to7<- lm(wppsi_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique);summary(lm_reasoning_sys3to7)
```

Finally, we explored the cognitive consequences of age-associated network segregation by examining relationships between functional architecture and visuospatial reasoning (matrix reasoning from Wechsler tests [@wechsler_wiscv_2014; @wechsler_wppsiiv_2012]; see Fig. 4a). Controlling for age, reasoning was positively associated with average within-system connectivity ($\beta =$ `r beta_lm_mean_within_sys_reasoning$standardized.coefficients[7]`, `r  summary_lm_mean_within_sys_reasoning$statistic$mean_within_sys`, $p_{FDR} =$ `r networks_reasoning_measures_pvals_fdr$corrected_pvalue[networks_reasoning_measures_pvals_fdr$measure=="mean_within_sys"]`), and negatively associated with average between-system connectivity ($\beta =$ `r beta_lm_mean_between_sys_reasoning$standardized.coefficients[7]`, `r  summary_lm_mean_between_sys_reasoning$statistic$mean_between_sys`, $p_{FDR} =$ `r networks_reasoning_measures_pvals_fdr$corrected_pvalue[networks_reasoning_measures_pvals_fdr$measure=="mean_between_sys"]`) and average participation coefficient ($\beta =$ `r beta_lm_part_coef_reasoning$standardized.coefficients[7]`, `r  summary_lm_part_coef_reasoning$statistic$part_coef`, $p_{FDR} =$ `r networks_reasoning_measures_pvals_fdr$corrected_pvalue[networks_reasoning_measures_pvals_fdr$measure=="part_coef"]`). However, these associations did not pass correction for multiple comparisons, and reasoning was not associated with other measures of whole-brain network architecture ($p$-values \> .05). At the system level, we focused on pairs of cognitive systems that show significant associations with age (see Fig. 2c), and found that connectivity between the visual and dorsal attention systems was positively associated with reasoning ability (Fig. 4b, $\beta =$ `r beta_lm_reasoning_sys1to3$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys1to3$statistic$sys1to3`, $p_{FDR} =$ `r printnum(networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys1to3"],digits = 4)`). We also found that connectivity between the default and dorsal attention systems was negatively associated with reasoning ability (Fig. 4b, $\beta =$ `r beta_lm_reasoning_sys3to7$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys3to7$statistic$sys3to7`, $p_{FDR} =$ `r networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys3to7"]`). Further, motivated by prior studies linking the frontoparietal system to reasoning [@wertheim_neural_2018; @prado_brain_2011], we tested whether reasoning was associated with within-system frontoparietal connectivity; we found no effect ($\beta =$ `r beta_lm_reasoning_sys6to6$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys6to6$statistic$sys6to6`, $p_{FDR} =$ `r networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys6to6"]`). At the parcel level, connections with the intraparietal sulcus (top parcel: 8 edges), as well as the medial prefrontal and occipital areas, showed positive relationships with reasoning (Fig. 4c). Parcels with positive reasoning effects were most numerous in the visual system (Fig. 4d). Connections with the frontal pole (top parcel: 8 edges), the intraparietal sulcus, the medial prefrontal cortex, and visual areas showed negative associations with reasoning (Fig. 4e). Parcels with negative reasoning effects were most numerous in the visual, default mode, and dorsal attention systems (Fig. 4f).

![**Figure 4. Associations between functional network structure and visuospatial reasoning. a.** Example reasoning item. Reasoning was assessed with the Matrix Reasoning subscale of the Weschler assessments. **b.** System-level associations with reasoning, controlling for age. Reasoning is associated with connectivity between the visual and dorsal attention systems, and with connectivity between the default mode and dorsal attention systems. **c.** The number of edges from each parcel showing a significant positive reasoning association; significance was defined as $p_{unc} < 0.001$. **d.** The number of edges with positive effects of reasoning, grouped by system. Each datapoint represents a parcel. **e.** The number of edges from each parcel showing a significant negative reasoning association; significance was defined as $p_{unc} < 0.001$. **f.** The number of edges with negative effects of reasoning, grouped by system. Each datapoint represents a parcel.](ms_figures/new_figures/fig_4-01.png)

## <span custom-style="BlueColor">Sensitivity analyses</span>

```{r Stringent pipeline replication segregation + age, include=FALSE, echo=FALSE}
pipeline='gsr_spkreg_fd0.25dvars1.75_drpvls'
network_dir=paste0("~/Documents/projects/in_progress/within_between_network_conn_CBPD/data/imageData/",pipeline)
load(paste0(network_dir,"/CBPD_n83_schaefer400_allruns_FD0.5mmcensored0.2mmnooutliers.Rdata"))
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome,"_age")
  formula<-formula(paste0(outcome, '~age_scan+male+fd_mean_avg+avgweight+totalSizet'))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(summary(get(model)), ))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_",model)
  assign(beta, lm.beta(get(model)))
}
#Correct across
covariates="~age_scan+male+fd_mean_avg+avgweight+totalSizet"
#make a dataframe with no repeats of net comparisons
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
#run and correct for multiple comparisons again
m <- mclapply(outcomes, function(sys) {as.formula(paste(sys,covariates, sep=""))},mc.cores=2)
networks_segreg_measures_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[2,4]},mc.cores=1)
networks_segreg_measures_pvals <- as.data.frame(networks_segreg_measures_pvals)
networks_segreg_measures_pvals <- t(networks_segreg_measures_pvals)
networks_segreg_measures_pvals <- as.data.frame(networks_segreg_measures_pvals)
#FDR correct
networks_segreg_measures_pvals_fdr <- cbind(networks_segreg_measures_pvals,data.frame(p.adjust(networks_segreg_measures_pvals$V1, method="fdr")))
networks_segreg_measures_pvals_fdr <- data.frame(networks_segreg_measures_pvals_fdr,rep(outcomes,1))
colnames(networks_segreg_measures_pvals_fdr) <- c("pvalue", "corrected_pvalue","measure")
networks_segreg_measures_pvals_fdr #Corrected for 6 tests!
```

<div custom-style="BlueParagraph"> We conducted a set of sensitivity analyses to ensure that our results were not dependent on particular analytical choices. Specifically, we conducted our main analyses with a more stringent preprocessing pipeline and motion exclusion criteria. In this pipeline, measures of functional network segregation were consistently positively associated with age, including average within-system connectivity ($\beta =$ `r beta_lm_mean_within_sys_age$standardized.coefficients[2]`, `r  summary_lm_mean_within_sys_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="mean_within_sys"], digits=3)`), average between-system connectivity ($\beta =$ `r beta_lm_mean_between_sys_age$standardized.coefficients[2]`, `r  summary_lm_mean_between_sys_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="mean_between_sys"], digits=3)`), overall system segregation ($\beta =$ `r beta_lm_system_segreg_age$standardized.coefficients[2]`, `r  summary_lm_system_segreg_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="system_segreg"], digits=2)`), the modularity quality index ($\beta =$ `r beta_lm_modul_avg_age$standardized.coefficients[2]`, `r  summary_lm_modul_avg_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="modul_avg"],digits=3)`), and the clustering coefficient ($\beta =$ `r beta_lm_avgclustco_both_age$standardized.coefficients[2]`, `r  summary_lm_avgclustco_both_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="avgclustco_both"],digits=2)`). Consistent with these associations, we found that the average participation coefficient, a measure that inversely tracks network segregation, was negatively correlated with age ($\beta =$ `r beta_lm_part_coef_age$standardized.coefficients[2]`, `r summary_lm_part_coef_age$statistic$age_scan`, $p_{FDR} =$ `r printnum(networks_segreg_measures_pvals_fdr$corrected_pvalue[networks_segreg_measures_pvals_fdr$measure=="part_coef"],digits=2)`, see Fig. 5a).

```{r Stringent pipeline replication system-specific effects, include=FALSE, echo=FALSE}
networks_age_pvals_fdr #FDR-corrected
outcomes <- main_unique %>% ungroup() %>% dplyr::select(matches("sys.to.")) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome)
  formula<-formula(paste0(outcome, '~age_scan+male+fd_mean_avg+avgweight+totalSizet'))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(summary(get(model)), digits = 5))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_", model)
  assign(beta, lm.beta(get(model)))
}
summary(lm_sys7to7)
# summary(lm_sys1to3);visreg(lm_sys1to3,"age_scan");lm.beta(lm_sys1to3)
# summary(lm_sys3to7);visreg(lm_sys3to7,"age_scan");lm.beta(lm_sys3to7)
# summary(lm_sys4to7);visreg(lm_sys4to7,"age_scan");lm.beta(lm_sys4to7)
# summary(lm_sys3to4);visreg(lm_sys3to4,"age_scan");lm.beta(lm_sys3to4)
```

At the system resolution, age was positively, but weakly, associated with within-system connectivity in the visual ($\beta =$ `r beta_lm_sys1to1$standardized.coefficients[2]`, `r  summary_lm_sys1to1$statistic$age_scan`) and limbic ($\beta =$ `r beta_lm_sys5to5$standardized.coefficients[2]`, `r  summary_lm_sys5to5$statistic$age_scan`) systems, and was marginally positively associated with within-system connectivity in the default mode ($\beta =$ `r beta_lm_sys7to7$standardized.coefficients[2]`, `r  summary_lm_sys7to7$statistic$age_scan`) and somatomotor systems ($\beta =$ `r beta_lm_sys2to2$standardized.coefficients[2]`, `r  summary_lm_sys2to2$statistic$age_scan`). None of these associations survived correction for multiple comparisons. In contrast, age was strongly associated with between-system connectivity (Fig. 5b). Age was negatively associated with connectivity between the default mode and ventral attention systems ($\beta =$ `r beta_lm_sys4to7$standardized.coefficients[2]`, `r  summary_lm_sys4to7$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys4to7"]`). Age was also negatively associated with connectivity between the default mode and dorsal attention systems ($\beta =$ `r beta_lm_sys3to7$standardized.coefficients[2]`, `r  summary_lm_sys3to7$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys3to7"]`), but this association was marginal after FDR correction. Additionally, age was positively correlated with connectivity between the visual and dorsal attention systems ($\beta =$ `r beta_lm_sys1to3$standardized.coefficients[2]`, `r  summary_lm_sys1to3$statistic$age_scan`, $p_{FDR} =$ `r networks_age_pvals_fdr$pvalue[networks_age_pvals_fdr$network=="sys1to3"]`).

```{r Stringent pipeline replication edge-level effects, include= F, echo=F}
## Edge-level analyses see manuscript_analyses.R file
```

We next examined age effects at the parcel level to characterize regional specificity. Parcels with the highest number of positive edge-level age effects were observed in the superior parietal lobule/intraparietal sulcus (2 parcels with 11 and 9 significant edges) and the occipital cortex (2 parcels with 10 and 9 significant edges; see Fig. 5d). Parcels with the highest number of negative edge-level age effects occurred in medial prefrontal cortex (8 edges) and intraparietal sulcus (7 edges; Fig. 5e).

```{r Stringent pipeline replication network structure to reasoning, echo=F, include=F}
main_unique$matrix_reasoning_both <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_scaled,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_scaled))
main_unique$matrix_reasoning_both_raw <- ifelse(is.na(main_unique$wppsi_matrix_valid),main_unique$wisc_matrix_raw,ifelse(main_unique$wppsi_matrix_valid==0,NA,main_unique$wppsi_matrix_raw))
main_unique$matrix_reasoning_both;main_unique$matrix_reasoning_both_raw

mr <- lm(matrix_reasoning_both_raw~age_behav.x, data=main_unique)
summary(mr)

#Test measures of segregation with reasoning
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
for (outcome in outcomes){
  model<-paste0("lm_",outcome,"_reasoning")
  formula<-formula(paste0('matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+',outcome))
  assign(model, lm(formula, data=main_unique))
  output <- paste0("summary_",model)
  assign(output, apa_print(Anova(get(model)), es="pes",mse=FALSE))
  eta <- paste0("eta_",model)
  assign(eta, eta_squared(Anova(get(model)), ci=0.95))
  cohensf <- paste0("cohensf_",model)
  assign(cohensf, cohens_f(Anova(get(model)), ci=0.95))
  beta <- paste0("beta_",model)
  assign(beta, lm.beta(get(model)))
  print(outcome)
  print(summary(get(model)))
}

#Correct across
covariates="matrix_reasoning_both~ age_scan+male+fd_mean_avg+avgweight+totalSizet+"
#make a dataframe with no repeats of net comparisons
outcomes <- main_unique %>% ungroup() %>% dplyr::select(mean_within_sys,mean_between_sys,system_segreg, modul_avg, part_coef,avgclustco_both) %>% names()
#run and compare for multiple comparisons again
m <- mclapply(outcomes, function(sys) {as.formula(paste(covariates, sys,sep=""))},mc.cores=2)
networks_reasoning_measures_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[7,4]},mc.cores=1)
networks_reasoning_measures_pvals <- as.data.frame(networks_reasoning_measures_pvals)
networks_reasoning_measures_pvals <- t(networks_reasoning_measures_pvals)
networks_reasoning_measures_pvals <- as.data.frame(networks_reasoning_measures_pvals)
#FDR correct
networks_reasoning_measures_pvals_fdr <- cbind(networks_reasoning_measures_pvals,data.frame(p.adjust(networks_reasoning_measures_pvals$V1, method="fdr")))
networks_reasoning_measures_pvals_fdr <- data.frame(networks_reasoning_measures_pvals_fdr,rep(outcomes,1))
colnames(networks_reasoning_measures_pvals_fdr) <- c("pvalue", "corrected_pvalue","measure")
networks_reasoning_measures_pvals_fdr #Corrected for 6 tests!

#Test all 4 age-sig systems with Reasoning
lm_reasoning_sys1to3<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique)
lm_reasoning_sys3to7<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique)
lm_reasoning_sys4to7<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys4to7, data=main_unique)
summary_lm_reasoning_sys1to3 <- apa_print(summary(lm_reasoning_sys1to3));beta_lm_reasoning_sys1to3 <- lm.beta(lm_reasoning_sys1to3)
eta_lm_reasoning_sys1to3 <- eta_squared(Anova(lm_reasoning_sys1to3), ci=0.95);cohensf_lm_reasoning_sys1to3 <- cohens_f(Anova(lm_reasoning_sys1to3), ci=0.95)
summary_lm_reasoning_sys3to7 <- apa_print(summary(lm_reasoning_sys3to7));beta_lm_reasoning_sys3to7 <- lm.beta(lm_reasoning_sys3to7)
eta_lm_reasoning_sys3to7 <- eta_squared(Anova(lm_reasoning_sys3to7), ci=0.95);cohensf_lm_reasoning_sys3to7 <- cohens_f(Anova(lm_reasoning_sys3to7), ci=0.95)
summary_lm_reasoning_sys4to7 <- apa_print(summary(lm_reasoning_sys4to7));beta_lm_reasoning_sys4to7 <- lm.beta(lm_reasoning_sys4to7)
eta_lm_reasoning_sys4to7 <- eta_squared(Anova(lm_reasoning_sys4to7), ci=0.95);cohensf_lm_reasoning_sys4to7 <- cohens_f(Anova(lm_reasoning_sys4to7), ci=0.95)

lm_reasoning_sys6to6<- lm(matrix_reasoning_both~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys6to6, data=main_unique)
summary_lm_reasoning_sys6to6 <- apa_print(summary(lm_reasoning_sys6to6));beta_lm_reasoning_sys6to6 <- lm.beta(lm_reasoning_sys6to6)

#Correct across
covariates="matrix_reasoning_both~ age_scan+male+fd_mean_avg+avgweight+totalSizet+"
#make a dataframe with no repeats of net comparisons
nets <- dplyr::select(main_unique, sys1to3,sys3to7,sys4to7,sys3to4, sys6to6) %>% ungroup %>% names()
nets <- nets[-1]
#run and compare for multiple comparisons again
m <- mclapply(nets, function(sys) {as.formula(paste(covariates, sys,sep=""))},mc.cores=2)
networks_reasoning_pvals <- mclapply(m, function(sys) { summary(lm(formula = sys,data=main_unique))$coefficients[7,4]},mc.cores=1)
networks_reasoning_pvals <- as.data.frame(networks_reasoning_pvals)
networks_reasoning_pvals <- t(networks_reasoning_pvals)
networks_reasoning_pvals <- as.data.frame(networks_reasoning_pvals)
#FDR correct
networks_reasoning_pvals_fdr <- cbind(networks_reasoning_pvals,data.frame(p.adjust(networks_reasoning_pvals$V1, method="fdr")))
networks_reasoning_pvals_fdr <- data.frame(networks_reasoning_pvals_fdr,rep(nets,1))
colnames(networks_reasoning_pvals_fdr) <- c("pvalue", "corrected_pvalue","network")
networks_reasoning_pvals_fdr #Corrected for 5 tests!

#Test 2 sig systems with Reasoning in separate samples
lm_reasoning_sys1to3<- lm(wisc_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique);summary(lm_reasoning_sys1to3)
lm_reasoning_sys1to3<- lm(wppsi_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys1to3, data=main_unique);summary(lm_reasoning_sys1to3)
lm_reasoning_sys3to7<- lm(wisc_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique);summary(lm_reasoning_sys3to7)
lm_reasoning_sys3to7<- lm(wppsi_matrix_scaled~age_scan+male+fd_mean_avg+avgweight+totalSizet+sys3to7, data=main_unique);summary(lm_reasoning_sys3to7)
```

Finally, we examined relations between functional architecture and visuospatial reasoning. Controlling for age, reasoning was marginally positively associated with average within-system connectivity ($\beta =$ `r beta_lm_mean_within_sys_reasoning$standardized.coefficients[7]`, `r  summary_lm_mean_within_sys_reasoning$statistic$mean_within_sys`, $p_{FDR} =$ `r networks_reasoning_measures_pvals_fdr$corrected_pvalue[networks_reasoning_measures_pvals_fdr$measure=="mean_within_sys"]`), and marginally negatively associated with average between-system connectivity ($\beta =$ `r beta_lm_mean_between_sys_reasoning$standardized.coefficients[7]`, `r  summary_lm_mean_between_sys_reasoning$statistic$mean_between_sys`, $p_{FDR} =$ `r networks_reasoning_measures_pvals_fdr$corrected_pvalue[networks_reasoning_measures_pvals_fdr$measure=="mean_between_sys"]`). However, these associations did not pass correction for multiple comparisons, and reasoning was not associated with other measures of whole-brain network architecture ($p$-values \> .05). At the system level, we focused on pairs of cognitive systems that showed associations with age in the main analyses, and found that connectivity between the visual and dorsal attention systems was positively associated with reasoning ability (Fig. 5e, $\beta =$ `r beta_lm_reasoning_sys1to3$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys1to3$statistic$sys1to3`, $p_{FDR} =$ `r printnum(networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys1to3"],digits = 4)`). We also found that connectivity between the default and dorsal attention systems was negatively associated with reasoning ability ($\beta =$ `r beta_lm_reasoning_sys3to7$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys3to7$statistic$sys3to7`, $p_{FDR} =$ `r printnum(networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys3to7"],digits=4)`). Reasoning was not associated with within-system frontoparietal connectivity ($\beta =$ `r beta_lm_reasoning_sys6to6$standardized.coefficients[7]`, `r  summary_lm_reasoning_sys6to6$statistic$sys6to6`, $p_{FDR} =$ `r networks_reasoning_pvals_fdr$corrected_pvalue[networks_reasoning_pvals_fdr$network=="sys6to6"]`). At the parcel level, connections with superior parietal cortex (8 edges) and visual areas (7 edges) showed positive relations with reasoning (Fig. 5f). Connections with the frontal pole (7 edges), superior parietal cortex (2 parcels with 7 and 6 edges), medial prefrontal cortex (6 edges), and visual areas showed negative associations with reasoning (Fig. 5g).

</div>
![<span custom-style="BlueColor">**Figure 5. Replication with stricter motion exclusions.** In this pipeline, we censored volumes with FD > 0.25mm and excluded participants with average FD > 0.5 mm. **a.** Whole-brain measures of functional network segregation (system segregation, modularity, and the clustering coefficient) are positively associated with age. The participation coefficient is a measure of functional network integration and is negatively associated with age. **b.** Age effects on between-system connectivity. **c.** Number of edges from each parcel showing a significant positive age association; significance was defined as $p_{unc} < 0.001$. **d.** Number of edges from each parcel showing a significant negative age association; significance was defined as $p_{unc} < 0.001$. **e.** System-level associations with reasoning, controlling for age. Reasoning is associated with connectivity between the visual and dorsal attention systems, and with connectivity between the default mode and dorsal attention systems. **f.** The number of edges from each parcel showing a significant positive reasoning association; significance was defined as $p_{unc} < 0.001$. **g.** The number of edges from each parcel showing a significant negative reasoning association; significance was defined as $p_{unc} < 0.001$.</span>](ms_figures/new_figures/supp_fig_replicate_0.25mm_pipeline-01.png)

# Discussion

We investigated the development of cortical functional network architecture during childhood. At the whole-brain level, age was positively associated with multiple measures of functional network segregation, consistent with prior work on development later in childhood and adolescence [@fair_functional_2009; @lopez_development_2019; @marek_contribution_2015]. At the system level, age was associated with a segregation of systems involved in attention from those involved in abstract, internally oriented cognition, as well as an integration among attentional and perceptual systems. At the parcel level, age effects on functional connectivity were strongest in medial prefrontal areas of the default mode system, and in areas of the visual system. Classically, brain development is thought to move from back to front, from sensory areas to association areas. Our results suggest another possibility: both ends of the sensory-association gradient are anchored early, perhaps by the presence or absence of sensory input, and then boundaries along the gradient are gradually solidified. This possibility is consistent with the very early emergence of the default mode network in utero and in infancy [@gao_evidence_2009; @gilmore_imaging_2018; @hodel_rapid_2018; @thomason_intrinsic_2014], and with work showing that medial prefrontal cortex, like primary sensory areas, is already highly segregated in adolescence [@baum_development_2020]. These findings fill a critical gap in our understanding of how intrinsic functional network remodeling supports the profound cognitive development that takes place during early and middle childhood.

Age effects were pronounced in areas of medial prefrontal cortex that <span custom-style="BlueColor">are</span> activated by self-referential thought and social perception tasks in adults [@de_la_vega_large-scale_2016; @meyer_why_2018; @parelman_overlapping_2021]. This result is consistent with evidence for major changes in social cognition between the ages of 3 and 10 years, supported by changes in the structure and function of the medial prefrontal cortex, the precuneus, and the temporoparietal junction [@weimer_correlates_2021]. Though we did not collect a behavioral or imaging measure of social cognition in this sample, we speculate that the medial prefrontal regions that show age effects may support improvements in social cognition in this age range. In this context, it is notable that medial prefrontal cortex continues developing after 10 years of age, and shows a protracted course of age-associated change through adolescence and into adulthood [@baum_development_2020]. The age-associated remodeling we observe in medial prefrontal cortex may be simply an early manifestation of the ongoing anchoring of the far end of the sensorimotor-association gradient that continues into adulthood.<span custom-style="BlueColor"> It is also possible that changes in medial prefrontal connectivity more broadly support self-regulation processes that are required for efficiently completing many types of tasks [@akshoomoff_nih_2014; @de_la_vega_large-scale_2016; @meyer_why_2018].</span>

Age effects were also pronounced in the visual system. <span custom-style="BlueColor">The visual network showed increased integration with the dorsal attention network, particularly along the dorsal stream.</span> The majority of inputs into primary visual cortex come from higher-order visual areas and attention areas [@muckli_network_2013], so it is possible that inputs from attention systems are reflected in the structure and function of perceptual areas. Indeed, attention improves substantially in early childhood [@amso_attentive_2015]. Further, connectivity within regions of the dorsal attention and visual systems is positively associated with attention skills in 4-7-year-old children [@rohr_functional_2017; @rohr_functional_2018], suggesting that the age effects we observe in regions of the visual system may also support developing attention skills.

Better reasoning abilities were associated with more mature patterns of brain network architecture, after controlling for age. At the parcel level, reasoning was associated with the connectivity of medial prefrontal and visual areas, as well as the intraparietal sulcus and the frontal pole. At the systems level, reasoning was associated with integration between the visual and dorsal attention systems, and with segregation between the default mode and dorsal attention systems. Prior work in older children and adults has linked structure and function of the frontoparietal system to reasoning skills, with a specific focus on rostral lateral prefrontal cortex and parietal areas [@prado_brain_2011; @vendetti_evolutionary_2014; @wertheim_neural_2018]. Interestingly, one study found that neural correlates of reasoning depended on age: after age 8 years, stronger reasoning skills were associated with stronger functional connectivity between rostral lateral prefrontal cortices and the inferior parietal lobe, whereas before age 8 years, there were no such associations [@wendelken_fronto-parietal_2016]. Similarly, we found no association between frontoparietal system connectivity and reasoning ability in our age range. By taking a whole brain approach rather than focusing on the frontoparietal network, we found that visuospatial reasoning is associated with integration between perceptual and attentional systems in children. We also found that reasoning was associated with segregation between task-positive and task-negative systems, consistent with other work across multiple age ranges and cognitive domains [@bruchhage_functional_2020; @chan_decreased_2014; @keller_resting-state_2015; @marek_identifying_2019]. The involvement of perceptual systems such as the visual and dorsal attention systems in reasoning may not be as surprising as it initially seems: in children and adults, reasoning tasks engage visual areas more than non-reasoning control tasks [@mackey_characterizing_2015; @soulieres_enhanced_2009; @whitaker_neuroscientific_2018]. There is also evidence that reasoning performance relies more on lower-level skills like processing speed and visuospatial attention than on higher-level skills like working memory and relational integration early in childhood [@fry_processing_1996; @kail_longitudinal_2016]. Broadly, our results suggest that maturation of brain network architecture, in particular in areas at two ends of the sensory-association gradient, supports the development of reasoning abilities.

<div custom-style="BlueParagraph">Making decisions about motion criteria is difficult because of tradeoffs between data quality and generalizability, as motion is often highly correlated with other sample characteristics of interest [@leonardHowMuchMotion2017; @boltonAgitoErgoSum2019; @hodgsonSharedGeneticFactors2017]. Our approach here was to analyze the data at two motion thresholds: a more lenient threshold that included more children and more data, and a more conservative threshold that minimized motion concerns. At both thresholds, the general pattern of findings was the same. At the whole-brain level, age was positively associated with measures of segregation. At the system level, age was positively associated with segregation between external and internal attention systems, and integration between attentional and perceptual systems. Although the specific parcel-level results were not identical, the broad pattern of results was similar, with age effects on functional connectivity being strongest in medial prefrontal cortex, superior parietal cortex, and visual areas. Better reasoning abilities were associated with more mature patterns of brain network architecture. This finding suggests that our results are robust to variation in sample definition and are not driven by motion.</div>

Several potential limitations should be noted. First, our dataset is cross-sectional <span custom-style="BlueColor">and of a relatively small sample size</span>. Future work with longitudinal data will be necessary to establish the temporal sequence of the relationships we report, as well as to better evaluate nonlinearities and ideally, developmental trajectories in children younger than age 4 years. <span custom-style="BlueColor">Longitudinal data would also make it possible to test whether changes in network structure mediate age-related improvements in reasoning.</span> Fortunately, such a study --- the HEALthy Brain and Cognitive Development Study [@volkow_healthy_2020] --- is about to begin. Second, by carefully excluding data with motion artifacts, we may have limited the generalizability of our findings. Most young children move in the scanner, so it is essential to develop more motion-resilient sequences to allow investigators to acquire data in a more representative sample of young kids. Third, our cognitive measures were limited. Future work is necessary to link changes in functional organization to changes across a broader set of cognitive and social skills, including abilities that might diminish with age, such as creativity and imagination [@gopnik_childhood_2020; @thompson-schill_cognition_2009]. Fourth, major cognitive and social changes during middle childhood (called the "age of reason" by anthropologists @sameroff_five_1996) have been observed across many cultures all over the world, but our sample only captures development in our specific geographic and cultural context. Finally, we could not determine the causes of the developmental patterns we uncovered. More work is needed to understand whether these patterns were associated with specific experiences, for example formal schooling [@brod_does_2017; @nolden_neural_2021], or simply reflect biological experience-independent maturation.

In sum, age effects on functional cortical architecture during childhood parallel long-known age effects on behavior. As children learn to resist the lure of perceptual information, and begin to reason abstractly, cortical systems for perception and abstraction separate, while connections that facilitate attention tend to strengthen. As children's concept of self matures, the connectivity of the medial prefrontal cortex changes. Our results provide new insights into how changes in cortical organization give rise to changes in the mind as children reach the age of reason.

# Citation diversity statement

Recent work in several fields of science---including neuroscience, where our work here is situated---has identified a bias in citation practices such that papers from women and other marginalized scholars are under-cited relative to the number of such papers in the field [@caplar_quantitative_2017; @dion_gendered_2018; @dworkin_extent_2020; @maliniak_gender_2013; @mitchell2013gendered; @chatterjee_gender_2021; @teich_citation_2021-1; @wang_gendered_2021]. Here we sought to proactively consider choosing references that reflect the diversity of the field in thought, form of contribution, gender, race, ethnicity, and other factors. First, we obtained the predicted gender of the first and last author of each reference by using databases that store the probability of a first name being carried by a woman [@dworkin_extent_2020; @zhou_gender_2020]. By this measure (and excluding self-citations to the first and last authors of our current paper), our references contain <span custom-style="BlueColor">26</span>% woman(first)/woman(last), <span custom-style="BlueColor">16</span>% man/woman, <span custom-style="BlueColor">20</span>% woman/man, and <span custom-style="BlueColor">38</span>% man/man categorization. This method is limited in that a) names, pronouns, and social media profiles used to construct the databases may not, in every case, be indicative of gender identity and b) it cannot account for intersex, non-binary, or transgender people. Second, we obtained the predicted racial/ethnic category of the first and last author of each reference by databases that store the probability of a first and last name being carried by an author of color [@ambekar2009name; @sood2018predicting]. By this measure (and excluding self-citations), our references contain <span custom-style="BlueColor">9.83</span>% author of color (first)/author of color(last), <span custom-style="BlueColor">16.45</span>% white author/author of color, <span custom-style="BlueColor">18.51</span>% author of color/white author, and <span custom-style="BlueColor">55.21</span>% white author/white author. This method is limited in that a) names and Florida Voter Data to make the predictions may not be indicative of racial/ethnic identity, and b) it cannot account for Indigenous and mixed-race authors, or those who may face differential biases due to the ambiguous racialization or ethnicization of their names. We look forward to future work that could help us to better understand how to support equitable practices in science.

# Author contributions

U.A. Tooley, D.S. Bassett, and A.P. Mackey developed the study concept. All authors contributed to the study design. Testing and data collection were performed by U.A. Tooley, A.T. Park, J.A. Leonard, A.L. Boroshok, and C.L. McDermott. U.A. Tooley performed the data analysis and interpretation under the supervision of A.P. Mackey and D.S. Bassett. U.A. Tooley and A.P. Mackey drafted the manuscript, and A.T. Park, J.A. Leonard, A.L. Boroshok, C.L. McDermott, and D.S. Bassett provided critical revisions. All authors approved the final version of the manuscript for submission.

# Acknowledgements

We thank the families who participated in this research. We would like to thank Jasmine Forde, Katrina Simon, Sophie Sharp, Yoojin Hahn, Stephanie Bugden, Jamie Bogert, Alexis Broussard, Ava Cruz, Samantha Ferleger, Destiny Frazier, Jessica George, Abigail Katz, Sun Min Kim, Hunter Liu, Dominique Martinez, Ortal Nakash, Emily Orengo, Christina Recto, Leah Sorcher, and Alexis Uria for their help with data acquisition. This research was supported by the Jacobs Foundation Early Career Award (A.P.M.), NIDA (1R34DA050297-01 to M.D.T. and A.P.M.), the LEGO Foundation (A.P.M.), the Behavioral and Cognitive Neuroscience Training Grant (NIH T32-MH017168 to A.T.P.), the MindCORE postdoctoral research fellowship (from the University of Pennsylvania to J.A.L.), National Science Foundation Graduate Research Fellowships to U.A.T., A.L.B., and C.L.M. under Grant No. DGE-1845298, and the National Institute of Mental Health (R21MH106799, R01MH113550, and RF1MH116920 to D.S.B.).

# References
